import{a as q}from"/build/_shared/chunk-SNSPQP6N.js";import{a as V,b as F}from"/build/_shared/chunk-PRH7VUOP.js";import{c as p,e as v,f as m,g as b,i as g,j as w}from"/build/_shared/chunk-E5IAN4VW.js";v();m();b();w();g();v();m();b();w();g();var e=p(V()),R=p(q()),r=p(F());function B(){let[I,O]=(0,e.useState)(!1),[h,L]=(0,e.useState)(!1),y=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)(null),c=(0,e.useRef)([]),[Q,T]=(0,e.useState)(!1),[G,x]=(0,e.useState)(""),[H,M]=(0,e.useState)(""),[S,N]=(0,e.useState)(""),[k,X]=(0,e.useState)(""),[Y,j]=(0,e.useState)([]),[Z,C]=(0,e.useState)([]),[U,E]=(0,e.useState)(null),[_,P]=(0,e.useState)(null),[ee,te]=(0,e.useState)("");function oe(){I||a.current&&(s.current=new MediaRecorder(a.current),s.current.start(),s.current.ondataavailable=function(u){c.current&&(c.current.push(u.data),L(!0))},O(!0))}(0,e.useEffect)(function(){let u=new R.Configuration({apiKey:"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"}),A=new R.OpenAIApi(u);async function D(f){let o=await A.createTranscription(f.stream(),"whisper-1");console.log(o)}if(I||c.current.length===0||!h)return;let d=new Blob(c.current,{type:"video/mp4"}),n=new Blob(c.current,{type:"audio/mpeg"});x(URL.createObjectURL(d)),M(URL.createObjectURL(n)),P(n),c.current=[],L(!1),T(!0),d.lastModified=new Date;let l=new File([n],"question.mpeg",{type:n.type});var i=URL.createObjectURL(l);let t=new FormData;t.append("file",n),t.append("model","whisper-1"),console.log(l),D(n)},[h]);async function ne(){s.current&&(s.current.stop(),O(!1))}return(0,e.useEffect)(function(){async function u(){function A(i){a.current=i,y.current&&(y.current.srcObject=i)}async function D(){a.current&&a.current.getTracks().forEach(t=>{t.stop()});let i={audio:{deviceId:S!==""?{exact:S}:void 0},video:{deviceId:k!==""?{exact:k}:void 0}};try{let t=await navigator.mediaDevices.getUserMedia(i);A(t)}catch(t){E(t)}}function d(){return navigator.mediaDevices.enumerateDevices()}function n(i){let t=[],f=[];for(let o of i)o.kind==="audioinput"?t.push({value:o.deviceId,label:o.label||`Microphone ${o.deviceId}`}):o.kind==="videoinput"&&f.push({value:o.deviceId,label:o.label||`Camera ${o.deviceId}`});j(t),C(f)}await D();let l=await d();n(l)}u()},[S,k]),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:(0,r.jsx)("video",{ref:y,autoPlay:!0,muted:!0,playsInline:!0})}),(0,r.jsx)("div",{children:U&&(0,r.jsx)("p",{children:U.message})})]})}export{B as default};
